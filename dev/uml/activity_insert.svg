<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="598px" preserveAspectRatio="none" style="width:914px;height:598px;" version="1.1" viewBox="0 0 914 598" width="914px" zoomAndPan="magnify">
    <defs />
    <g><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="95" x="807" y="19.2822">version: 24.09.2020</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="98" x="407" y="38.3486">MaSeMiWa</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="165" x="373.5" y="59.3018">INSERT-Procedure</text>
        <ellipse cx="270" cy="73.5469" fill="#000000" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;" />
        <path d="M221.5,103.5469 L216.5,120.5313 L221.5,137.5156 M318.5,103.5469 L323.5,120.5313 L318.5,137.5156 " fill="#FFFFFF" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="226.5" y="124.6855">file link known</text>
        <polygon fill="#FEFECE" points="209.5,157.5156,330.5,157.5156,342.5,169.5156,330.5,181.5156,209.5,181.5156,197.5,169.5156,209.5,157.5156" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="209.5" y="173.3237">fetch metadata for ID</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="29" x="168.5" y="166.9214">error</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="342.5" y="166.9214">success</text>
        <rect fill="#FFAAAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="11" y="191.5156" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="21" y="212.6543">Return 404</text>
        <ellipse cx="56" cy="256.4844" fill="#FFFFFF" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;" />
        <ellipse cx="56" cy="256.4844" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;" />
        <polygon fill="#FEFECE" points="123,283.4844,255,283.4844,267,295.4844,255,307.4844,123,307.4844,111,295.4844,123,283.4844" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="193" y="317.6948">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="123" y="299.2925">check MIME in allow list</text>
        <polygon fill="#FEFECE" points="299,283.4844,375,283.4844,387,295.4844,375,307.4844,299,307.4844,287,295.4844,299,283.4844" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="31" x="341" y="317.6948">failed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="299" y="299.2925">Download file</text>
        <polygon fill="#FEFECE" points="419,283.4844,489,283.4844,501,295.4844,489,307.4844,419,307.4844,407,295.4844,419,283.4844" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="458" y="317.6948">invalid</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="70" x="419" y="299.2925">validate XML</text>
        <polygon fill="#FEFECE" points="533,283.4844,647,283.4844,659,295.4844,647,307.4844,533,307.4844,521,295.4844,533,283.4844" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="594" y="317.6948">invalid</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="533" y="299.2925">validate namespace</text>
        <polygon fill="#FEFECE" points="691,283.4844,815,283.4844,827,295.4844,815,307.4844,691,307.4844,679,295.4844,691,283.4844" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="31" x="757" y="317.6948">failed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="691" y="299.2925">send INSERT to Morre</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="827" y="292.8901">success</text>
        <rect fill="#FEFECE" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="39" x="474.5" y="379.1948" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="19" x="484.5" y="400.3335">log</text>
        <rect fill="#FEFECE" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="400" y="191.5156" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="73" x="410" y="212.6543">iterate over</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="487" y="212.6543">content_blobs</text>
        <polygon fill="#FEFECE" points="464.5,433.1636,523.5,433.1636,535.5,445.1636,523.5,457.1636,464.5,457.1636,452.5,445.1636,464.5,433.1636" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="464.5" y="448.9717">next item?</text>
        <polygon fill="#FEFECE" points="437,477.1636,551,477.1636,563,489.1636,551,501.1636,437,501.1636,425,489.1636,437,477.1636" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="437" y="492.9717">s.th. was imported?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="405" y="486.5693">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="563" y="486.5693">no</text>
        <rect fill="#AAFFAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="370" y="511.1636" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="380" y="532.3022">Return 200</text>
        <ellipse cx="415" cy="576.1323" fill="#FFFFFF" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;" />
        <ellipse cx="415" cy="576.1323" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;" />
        <rect fill="#FFAAAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="528" y="511.1636" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="538" y="532.3022">Return 400</text>
        <ellipse cx="573" cy="576.1323" fill="#FFFFFF" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;" />
        <ellipse cx="573" cy="576.1323" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="270" x2="270" y1="83.5469" y2="103.5469" />
        <polygon fill="#A80036" points="266,93.5469,270,103.5469,274,93.5469,270,97.5469" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="56" x2="56" y1="225.4844" y2="245.4844" />
        <polygon fill="#A80036" points="52,235.4844,56,245.4844,60,235.4844,56,239.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="189" x2="189" y1="307.4844" y2="359.1948" />
        <polygon fill="#A80036" points="185,349.1948,189,359.1948,193,349.1948,189,353.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="337" x2="337" y1="307.4844" y2="359.1948" />
        <polygon fill="#A80036" points="333,349.1948,337,359.1948,341,349.1948,337,353.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="454" x2="454" y1="307.4844" y2="359.1948" />
        <polygon fill="#A80036" points="450,349.1948,454,359.1948,458,349.1948,454,353.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="590" x2="590" y1="307.4844" y2="359.1948" />
        <polygon fill="#A80036" points="586,349.1948,590,359.1948,594,349.1948,590,353.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="753" x2="753" y1="307.4844" y2="359.1948" />
        <polygon fill="#A80036" points="749,349.1948,753,359.1948,757,349.1948,753,353.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="267" x2="287" y1="295.4844" y2="295.4844" />
        <polygon fill="#A80036" points="277,291.4844,287,295.4844,277,299.4844,281,295.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="387" x2="407" y1="295.4844" y2="295.4844" />
        <polygon fill="#A80036" points="397,291.4844,407,295.4844,397,299.4844,401,295.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="501" x2="521" y1="295.4844" y2="295.4844" />
        <polygon fill="#A80036" points="511,291.4844,521,295.4844,511,299.4844,515,295.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="679" y1="295.4844" y2="295.4844" />
        <polygon fill="#A80036" points="669,291.4844,679,295.4844,669,299.4844,673,295.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="494" x2="494" y1="225.4844" y2="258.4844" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="494" x2="189" y1="258.4844" y2="258.4844" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="189" x2="189" y1="258.4844" y2="283.4844" />
        <polygon fill="#A80036" points="185,273.4844,189,283.4844,193,273.4844,189,277.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="827" x2="862" y1="295.4844" y2="295.4844" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="862" x2="862" y1="295.4844" y2="359.1948" />
        <polygon fill="#A80036" points="858,349.1948,862,359.1948,866,349.1948,862,353.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="189" x2="862" y1="359.1948" y2="359.1948" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="494" x2="494" y1="359.1948" y2="379.1948" />
        <polygon fill="#A80036" points="490,369.1948,494,379.1948,498,369.1948,494,373.1948" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="535.5" x2="888" y1="445.1636" y2="445.1636" />
        <polygon fill="#A80036" points="884,339.1948,888,329.1948,892,339.1948,888,335.1948" style="stroke: #A80036; stroke-width: 1.5;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="888" x2="888" y1="208.5" y2="445.1636" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="888" x2="588" y1="208.5" y2="208.5" />
        <polygon fill="#A80036" points="598,204.5,588,208.5,598,212.5,594,208.5" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="494" x2="494" y1="413.1636" y2="433.1636" />
        <polygon fill="#A80036" points="490,423.1636,494,433.1636,498,423.1636,494,427.1636" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="415" x2="415" y1="545.1323" y2="565.1323" />
        <polygon fill="#A80036" points="411,555.1323,415,565.1323,419,555.1323,415,559.1323" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="573" x2="573" y1="545.1323" y2="565.1323" />
        <polygon fill="#A80036" points="569,555.1323,573,565.1323,577,555.1323,573,559.1323" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="425" x2="415" y1="489.1636" y2="489.1636" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="415" x2="415" y1="489.1636" y2="511.1636" />
        <polygon fill="#A80036" points="411,501.1636,415,511.1636,419,501.1636,415,505.1636" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="563" x2="573" y1="489.1636" y2="489.1636" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="573" x2="573" y1="489.1636" y2="511.1636" />
        <polygon fill="#A80036" points="569,501.1636,573,511.1636,577,501.1636,573,505.1636" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="494" x2="494" y1="457.1636" y2="477.1636" />
        <polygon fill="#A80036" points="490,467.1636,494,477.1636,498,467.1636,494,471.1636" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="197.5" x2="56" y1="169.5156" y2="169.5156" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="56" x2="56" y1="169.5156" y2="191.5156" />
        <polygon fill="#A80036" points="52,181.5156,56,191.5156,60,181.5156,56,185.5156" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="494" y1="169.5156" y2="169.5156" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="494" x2="494" y1="169.5156" y2="191.5156" />
        <polygon fill="#A80036" points="490,181.5156,494,191.5156,498,181.5156,494,185.5156" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="270" x2="270" y1="137.5156" y2="157.5156" />
        <polygon fill="#A80036" points="266,147.5156,270,157.5156,274,147.5156,270,151.5156" style="stroke: #A80036; stroke-width: 1.0;" />
        <!--MD5=[537160f089b4de311bf0fa82f6f1d487]
@startuml

title: MaSeMiWa\nINSERT-Procedure
header version: %date("dd.MM.yyyy")

skinparam shadowing false


!define     info(text)      #fff:text}
!definelong stoperror(text)
    #faa:text;
    stop
!enddefinelong
!definelong stopsuccess(text)
    #afa:text;
    stop
!enddefinelong
!definelong file_failed()
''    :log;
''    info(continue)
''    detach
!enddefinelong

start

info(file link known)

if (fetch metadata for ID) then (error)
    stoperror(Return 404)

else (success)
    repeat :iterate over ""content_blobs"";
        if (check MIME in allow list) then (no)
            file_failed()
        elseif (Download file) then (failed)
            file_failed()
        elseif (validate XML) then (invalid)
            file_failed()
        elseif (validate namespace) then (invalid)
            file_failed()
        elseif (send INSERT to Morre) then (failed)
            file_failed()
        else (success)
''            :log "imported model xyz";
        endif
        
        :log;
        
    repeat while (next item?)

    if (s.th. was imported?) then (yes)
        stopsuccess(Return 200)
    else (no)
        stoperror(Return 400)

endif


@enduml

@startuml

title: MaSeMiWa\nINSERT-Procedure
header version: 24.09.2020

skinparam shadowing false



start

#fff:file link known}

if (fetch metadata for ID) then (error)
        #faa:Return 404;
    stop

else (success)
    repeat :iterate over ""content_blobs"";
        if (check MIME in allow list) then (no)
                    elseif (Download file) then (failed)
                    elseif (validate XML) then (invalid)
                    elseif (validate namespace) then (invalid)
                    elseif (send INSERT to Morre) then (failed)
                    else (success)
        endif
        
        :log;
        
    repeat while (next item?)

    if (s.th. was imported?) then (yes)
            #afa:Return 200;
    stop
    else (no)
            #faa:Return 400;
    stop

endif


@enduml

PlantUML version 1.2020.16(Sun Aug 23 22:20:43 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
-->
    </g>
</svg>