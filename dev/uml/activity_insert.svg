<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="635px" preserveAspectRatio="none" style="width:823px;height:635px;" version="1.1" viewBox="0 0 823 635" width="823px" zoomAndPan="magnify">
    <defs />
    <g><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="95" x="716" y="19.2822">version: 20.10.2020</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="98" x="361.5" y="38.3486">MaSeMiWa</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="165" x="328" y="59.3018">INSERT-Procedure</text>
        <ellipse cx="247" cy="73.5469" fill="#000000" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;" />
        <path d="M198.5,103.5469 L193.5,120.5313 L198.5,137.5156 M295.5,103.5469 L300.5,120.5313 L295.5,137.5156 " fill="#FFFFFF" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="203.5" y="124.6855">file link known</text>
        <polygon fill="#FEFECE" points="186.5,157.5156,307.5,157.5156,319.5,169.5156,307.5,181.5156,186.5,181.5156,174.5,169.5156,186.5,157.5156" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="186.5" y="173.3237">fetch metadata for ID</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="29" x="145.5" y="166.9214">error</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="319.5" y="166.9214">success</text>
        <rect fill="#FFAAAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="11" y="191.5156" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="21" y="212.6543">Return 404</text>
        <ellipse cx="56" cy="256.4844" fill="#FFFFFF" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;" />
        <ellipse cx="56" cy="256.4844" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;" />
        <polygon fill="#FEFECE" points="123,284.2891,255,284.2891,267,296.2891,255,308.2891,123,308.2891,111,296.2891,123,284.2891" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="193" y="318.4995">no</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="123" y="300.0972">check MIME in allow list</text>
        <polygon fill="#FEFECE" points="299,284.2891,375,284.2891,387,296.2891,375,308.2891,299,308.2891,287,296.2891,299,284.2891" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="31" x="341" y="318.4995">failed</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="299" y="300.0972">Download file</text>
        <polygon fill="#FEFECE" points="419,284.2891,489,284.2891,501,296.2891,489,308.2891,419,308.2891,407,296.2891,419,284.2891" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="458" y="318.4995">invalid</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="70" x="419" y="300.0972">validate XML</text>
        <polygon fill="#FEFECE" points="533,283.4844,647,283.4844,659,296.2891,647,309.0938,533,309.0938,521,296.2891,533,283.4844" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="594" y="319.3042">invalid</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="533" y="293.6948">validate namespace</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="533" y="306.4995">and level/version</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="659" y="293.6948">success</text>
        <rect fill="#AAFFAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="679" y="323.0879" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="86" x="689" y="344.2266">add to Queue</text>
        <rect fill="#FEFECE" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="39" x="428.5" y="417.0566" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="19" x="438.5" y="438.1953">log</text>
        <rect fill="#FEFECE" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="188" x="354" y="191.5156" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="73" x="364" y="212.6543">iterate over</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="91" x="441" y="212.6543">content_blobs</text>
        <polygon fill="#FEFECE" points="418.5,471.0254,477.5,471.0254,489.5,483.0254,477.5,495.0254,418.5,495.0254,406.5,483.0254,418.5,471.0254" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="418.5" y="486.8335">next item?</text>
        <polygon fill="#FEFECE" points="371,515.0254,525,515.0254,537,527.0254,525,539.0254,371,539.0254,359,527.0254,371,515.0254" style="stroke: #A80036; stroke-width: 1.5;" /><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="154" x="371" y="530.8335">s.th. was added to Queue?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="339" y="524.4312">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="537" y="524.4312">no</text>
        <rect fill="#AAFFAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="304" y="549.0254" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="314" y="570.1641">Return 200</text>
        <ellipse cx="349" cy="613.9941" fill="#FFFFFF" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;" />
        <ellipse cx="349" cy="613.9941" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;" />
        <rect fill="#FFAAAA" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="502" y="549.0254" /><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="512" y="570.1641">Return 400</text>
        <ellipse cx="547" cy="613.9941" fill="#FFFFFF" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;" />
        <ellipse cx="547" cy="613.9941" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="247" x2="247" y1="83.5469" y2="103.5469" />
        <polygon fill="#A80036" points="243,93.5469,247,103.5469,251,93.5469,247,97.5469" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="56" x2="56" y1="225.4844" y2="245.4844" />
        <polygon fill="#A80036" points="52,235.4844,56,245.4844,60,235.4844,56,239.4844" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="189" x2="189" y1="308.2891" y2="397.0566" />
        <polygon fill="#A80036" points="185,387.0566,189,397.0566,193,387.0566,189,391.0566" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="337" x2="337" y1="308.2891" y2="397.0566" />
        <polygon fill="#A80036" points="333,387.0566,337,397.0566,341,387.0566,337,391.0566" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="454" x2="454" y1="308.2891" y2="397.0566" />
        <polygon fill="#A80036" points="450,387.0566,454,397.0566,458,387.0566,454,391.0566" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="590" x2="590" y1="309.0938" y2="397.0566" />
        <polygon fill="#A80036" points="586,387.0566,590,397.0566,594,387.0566,590,391.0566" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="267" x2="287" y1="296.2891" y2="296.2891" />
        <polygon fill="#A80036" points="277,292.2891,287,296.2891,277,300.2891,281,296.2891" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="387" x2="407" y1="296.2891" y2="296.2891" />
        <polygon fill="#A80036" points="397,292.2891,407,296.2891,397,300.2891,401,296.2891" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="501" x2="521" y1="296.2891" y2="296.2891" />
        <polygon fill="#A80036" points="511,292.2891,521,296.2891,511,300.2891,515,296.2891" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="448" x2="448" y1="225.4844" y2="258.4844" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="448" x2="189" y1="258.4844" y2="258.4844" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="189" x2="189" y1="258.4844" y2="284.2891" />
        <polygon fill="#A80036" points="185,274.2891,189,284.2891,193,274.2891,189,278.2891" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="659" x2="732" y1="296.2891" y2="296.2891" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="732" x2="732" y1="296.2891" y2="323.0879" />
        <polygon fill="#A80036" points="728,313.0879,732,323.0879,736,313.0879,732,317.0879" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="732" x2="732" y1="357.0566" y2="397.0566" />
        <polygon fill="#A80036" points="728,387.0566,732,397.0566,736,387.0566,732,391.0566" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="189" x2="732" y1="397.0566" y2="397.0566" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="448" x2="448" y1="397.0566" y2="417.0566" />
        <polygon fill="#A80036" points="444,407.0566,448,417.0566,452,407.0566,448,411.0566" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="489.5" x2="797" y1="483.0254" y2="483.0254" />
        <polygon fill="#A80036" points="793,377.0566,797,367.0566,801,377.0566,797,373.0566" style="stroke: #A80036; stroke-width: 1.5;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="797" x2="797" y1="208.5" y2="483.0254" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="797" x2="542" y1="208.5" y2="208.5" />
        <polygon fill="#A80036" points="552,204.5,542,208.5,552,212.5,548,208.5" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="448" x2="448" y1="451.0254" y2="471.0254" />
        <polygon fill="#A80036" points="444,461.0254,448,471.0254,452,461.0254,448,465.0254" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="349" x2="349" y1="582.9941" y2="602.9941" />
        <polygon fill="#A80036" points="345,592.9941,349,602.9941,353,592.9941,349,596.9941" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="547" x2="547" y1="582.9941" y2="602.9941" />
        <polygon fill="#A80036" points="543,592.9941,547,602.9941,551,592.9941,547,596.9941" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="359" x2="349" y1="527.0254" y2="527.0254" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="349" x2="349" y1="527.0254" y2="549.0254" />
        <polygon fill="#A80036" points="345,539.0254,349,549.0254,353,539.0254,349,543.0254" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="537" x2="547" y1="527.0254" y2="527.0254" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="547" x2="547" y1="527.0254" y2="549.0254" />
        <polygon fill="#A80036" points="543,539.0254,547,549.0254,551,539.0254,547,543.0254" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="448" x2="448" y1="495.0254" y2="515.0254" />
        <polygon fill="#A80036" points="444,505.0254,448,515.0254,452,505.0254,448,509.0254" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="174.5" x2="56" y1="169.5156" y2="169.5156" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="56" x2="56" y1="169.5156" y2="191.5156" />
        <polygon fill="#A80036" points="52,181.5156,56,191.5156,60,181.5156,56,185.5156" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="319.5" x2="448" y1="169.5156" y2="169.5156" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="448" x2="448" y1="169.5156" y2="191.5156" />
        <polygon fill="#A80036" points="444,181.5156,448,191.5156,452,181.5156,448,185.5156" style="stroke: #A80036; stroke-width: 1.0;" />
        <line style="stroke: #A80036; stroke-width: 1.5;" x1="247" x2="247" y1="137.5156" y2="157.5156" />
        <polygon fill="#A80036" points="243,147.5156,247,157.5156,251,147.5156,247,151.5156" style="stroke: #A80036; stroke-width: 1.0;" />
        <!--MD5=[3d6f23e192fa3a60f2226244cb5fe59d]
@startuml

title: MaSeMiWa\nINSERT-Procedure
header version: %date("dd.MM.yyyy")

skinparam shadowing false


!define     info(text)      #fff:text}
!definelong stoperror(text)
    #faa:text;
    stop
!enddefinelong
!definelong stopsuccess(text)
    #afa:text;
    stop
!enddefinelong
!definelong file_failed()
''    :log;
''    info(continue)
''    detach
!enddefinelong

start

info(file link known)

if (fetch metadata for ID) then (error)
    stoperror(Return 404)

else (success)
    repeat :iterate over ""content_blobs"";
        if (check MIME in allow list) then (no)
            file_failed()
        elseif (Download file) then (failed)
            file_failed()
        elseif (validate XML) then (invalid)
            file_failed()
        elseif (validate namespace\nand level/version) then (invalid)
            file_failed()
        else (success)
            #afa:add to Queue;
''            :log "imported model xyz";
        endif
        
        :log;
        
    repeat while (next item?)

    if (s.th. was added to Queue?) then (yes)
        stopsuccess(Return 200)
    else (no)
        stoperror(Return 400)

endif


@enduml

@startuml

title: MaSeMiWa\nINSERT-Procedure
header version: 20.10.2020

skinparam shadowing false



start

#fff:file link known}

if (fetch metadata for ID) then (error)
        #faa:Return 404;
    stop

else (success)
    repeat :iterate over ""content_blobs"";
        if (check MIME in allow list) then (no)
                    elseif (Download file) then (failed)
                    elseif (validate XML) then (invalid)
                    elseif (validate namespace\nand level/version) then (invalid)
                    else (success)
            #afa:add to Queue;
        endif
        
        :log;
        
    repeat while (next item?)

    if (s.th. was added to Queue?) then (yes)
            #afa:Return 200;
    stop
    else (no)
            #faa:Return 400;
    stop

endif


@enduml

PlantUML version 1.2020.16(Sun Aug 23 22:20:43 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
-->
    </g>
</svg>